# -*- coding: utf-8 -*-
"""Untitled7.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1GUEKqADRl4Rwfoh_gWuTdTt51srKUca7
"""

import numpy as np

import pandas as pd

import random

np.random.seed(42) # For reproducibility
n_samples = 100 # Number of samples

data = {
    'age': np.random.randint(18, 60, size=n_samples),
    'salary': np.random.randint(30000, 120000, size=n_samples),
    'department': np.random.choice(['IT', 'HR', 'Finance', 'Marketing'], size=n_samples),
    'years_experience': np.round(np.random.normal(5, 2, size=n_samples), 1),
    'is_manager': np.random.choice([0, 1], size=n_samples)
}
df = pd.DataFrame(data)



""" Q1. View data structure"""

df.info()


"""Q2. Get DataFrame Info and Summary Stats"""

df.describe(include ='all')


"""Q3. Do Simple Numpy Operations

#Mean , Medain, Standard Deviation
# Mean salary
mean_salary = np.mean(df['salary'])
print("Number of managers:", mean_salary)

# Median age
median_age = np.median(df['age'])
print(f"Median employee age: {median_age} years")


# Standard deviation of years of experience
std_experience = np.std(df['years_experience'])
print(f" Employee Experience: {std_experience} years Experience ")

#Aggregation and Conditions
# Count of managers
num_managers = np.sum(df['is_manager'])
print("Total number of managers are there in company:",num_managers)

# Employees with more than 10 years experience
experienced = df['years_experience'] > 10
num_experienced = np.sum(experienced)
print("\nNumber of employees with more thatn 10 years of experience in company:",num_experienced)

#Random and array operation
salary_array = df['salary'].to_numpy()
print("\n Salary data about all employees:")
print(salary_array)
normalized_salary = (salary_array - np.min(salary_array)) / (np.max(salary_array) - np.min(salary_array))

#Random operation
print("\n Normalization Salary of employees")
print(normalized_salary)


"""Q4. Filtering and Indexing Rows"""

# First 5 rows
df.iloc[:5]

df_indexed = df.set_index('department')
print(df_indexed )
df_indexed.loc['Finance']
print(df_indexed.loc)


"""Q5. Adding a Column"""

df['company'] = 'TechCorp'
df.head()
# Calculate salary per year of experience
df['salary_per_year'] = (df['salary'] / df['years_experience']).round(2)
df.head()

# Random performance score between 1 and 10
df['performance_score'] = np.random.randint(1, 11, size=len(df))
df.head()

# Flag high earners
df['high_earner'] = df['salary'] > 100000
df.head()
#df.tail()


"""Q6. Grouping and Aggregation"""

df.groupby('department').size()

df.groupby('department')['salary'].mean()

df.groupby('department')['is_manager'].sum()

df.groupby('is_manager')['years_experience'].agg(['mean', 'min', 'max'])
